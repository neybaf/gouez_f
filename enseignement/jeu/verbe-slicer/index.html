<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verbe Slicer - Version Simple</title>
    <!-- CSS AUTONOME - Nécessaire car le jeu était perturbé par le CSS des autres jeux -->
    <!-- Toutes les améliorations mobiles sont intégrées directement ici pour maintenir l'autonomie -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
            color: white;
            overflow: hidden;
            /* Optimisations mobiles intégrées */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* AMÉLIORATIONS MOBILES INTÉGRÉES */
        
        /* Optimisations tactiles pour tous les éléments cliquables */
        button, .game-btn, .difficulty-btn, .ui-btn {
            min-height: 44px; /* Taille recommandée Apple/Google pour les éléments tactiles */
            min-width: 44px;
            touch-action: manipulation; /* Évite le zoom sur double-tap */
        }
        
        /* Optimisations pour écrans tactiles */
        @media (pointer: coarse) {
            .game-btn, .difficulty-btn {
                min-height: 48px;
                padding: 12px 24px;
                font-size: 1.1rem;
            }
            
            .ui-btn {
                min-height: 48px;
                min-width: 48px;
                font-size: 1.3rem;
            }
        }
        
        /* Debug styles */
        .debug-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.9);
            color: #00ff00;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            z-index: 2000;
            max-width: 300px;
            border: 1px solid #333;
        }
        .debug-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            margin: 2px;
            font-size: 11px;
        }
        
        /* ÉCRANS DE JEU - DESIGN NOIR */
        .game-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: none;
            z-index: 100;
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #000000 100%);
            color: white;
            overflow: hidden;
        }
        
        .game-screen.active {
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .game-screen.overlay.active {
            display: flex !important;
            align-items: center;
            justify-content: center;
        }
        
        /* ÉCRAN DE DÉMARRAGE */
        #start-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            background: radial-gradient(ellipse at center, #1a1a1a 0%, #000000 100%);
        }
        
        .game-header {
            margin-bottom: 40px;
        }
        
        .game-title {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient 3s ease infinite;
            margin-bottom: 20px;
            text-shadow: 0 0 30px rgba(255, 107, 107, 0.5);
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .title-icon {
            font-size: 3rem;
            margin-right: 20px;
        }
        
        .game-subtitle {
            font-size: 1.5rem;
            color: #888;
            margin-bottom: 30px;
        }
        
        /* BOUTONS */
        .game-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            margin: 10px;
            min-width: 200px;
        }
        
        .game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        .game-btn.primary {
            background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 100%);
            box-shadow: 0 6px 25px rgba(255, 107, 107, 0.4);
            font-size: 1.3rem;
            padding: 20px 40px;
            animation: pulse-glow 2s ease-in-out infinite;
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 6px 25px rgba(255, 107, 107, 0.4); }
            50% { box-shadow: 0 8px 35px rgba(255, 107, 107, 0.7); }
        }
        
        /* SÉLECTEUR DE DIFFICULTÉ */
        .difficulty-selector {
            margin: 30px 0;
        }
        
        .difficulty-selector h3 {
            margin-bottom: 20px;
            color: #ccc;
        }
        
        .difficulty-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .difficulty-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-width: 120px;
        }
        
        .difficulty-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .difficulty-btn.active {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border-color: #4ecdc4;
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.5);
        }
        
        .difficulty-icon {
            font-size: 1.5rem;
            display: block;
            margin-bottom: 5px;
        }
        
        /* ÉCRAN DE JEU */
        #game-screen {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
        }
        
        .game-ui {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 200;
        }
        
        .ui-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
        }
        
        .score-display, .level-display {
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 25px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .score-value, .level-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #4ecdc4;
        }
        
        .level-name {
            font-size: 0.9rem;
            color: #888;
            display: block;
        }
        
        .lives-display {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .lives-hearts {
            display: flex;
            gap: 5px;
        }
        
        .heart {
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .heart.lost {
            opacity: 0.3;
            filter: grayscale(100%);
        }
        
        .ui-btn {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            pointer-events: all;
        }
        
        #game-canvas {
            width: 100%;
            height: 100%;
            display: block;
            background: transparent;
        }
        
        /* ÉCRANS OVERLAY */
        .game-screen.overlay {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
        }
        
        .pause-content, .game-over-content {
            background: rgba(20, 20, 20, 0.95);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
            max-width: 500px;
            width: 90%;
        }
        
        .pause-content h2, .game-over-content h2 {
            margin-bottom: 30px;
            font-size: 2rem;
        }
        
        .pause-stats, .final-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-item, .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-label {
            display: block;
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .stat-value {
            display: block;
            color: #4ecdc4;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .stat-icon {
            font-size: 1.2rem;
            margin-right: 8px;
        }
        
        .performance-message {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            color: #4ecdc4;
        }
        
        .pause-buttons, .game-over-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .game-title {
                font-size: 2.5rem;
            }
            
            .difficulty-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .ui-top {
                flex-direction: column;
                gap: 10px;
            }
            
            .pause-content, .game-over-content {
                padding: 20px;
            }
        }
        
        /* BARRE DE PROGRESSION - CSS MANQUANT */
        .progress-container {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            text-align: center;
            z-index: 1000;
        }
        
        .progress-label {
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 8px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #4ecdc4, #44a08d);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progressShine 2s infinite;
        }
        
        @keyframes progressShine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .progress-text {
            color: #4ecdc4;
            font-size: 0.8rem;
            margin-top: 5px;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        /* Responsive pour la barre de progression */
        @media (max-width: 768px) {
            .progress-container {
                width: 250px;
                bottom: 15px;
            }
            
            .progress-label, .progress-text {
                font-size: 0.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .progress-container {
                width: 200px;
                bottom: 10px;
            }
            
            .progress-bar {
                height: 6px;
            }
        }
        
        /* RESPONSIVE BREAKPOINTS INTÉGRÉS */
        @media (max-width: 1024px) {
            .game-title {
                font-size: 3rem;
            }
            
            .difficulty-buttons {
                gap: 15px;
            }
        }
        
        @media (max-width: 768px) {
            .game-title {
                font-size: 2.5rem;
            }
            
            .game-subtitle {
                font-size: 1.2rem;
            }
            
            .difficulty-buttons {
                flex-direction: column;
                align-items: center;
                gap: 12px;
            }
            
            .difficulty-btn {
                min-width: 200px;
                padding: 15px 20px;
            }
            
            .ui-top {
                flex-direction: column;
                gap: 10px;
                padding: 15px;
            }
            
            .score-display, .level-display, .lives-display {
                padding: 8px 16px;
            }
            
            .pause-content, .game-over-content {
                padding: 20px;
                margin: 10px;
            }
            
            .final-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .game-title {
                font-size: 2rem;
            }
            
            .game-subtitle {
                font-size: 1rem;
            }
            
            .game-btn {
                min-width: 180px;
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .ui-top {
                padding: 10px;
            }
            
            .score-display, .level-display, .lives-display {
                padding: 6px 12px;
                font-size: 0.9rem;
            }
            
            .score-value, .level-value {
                font-size: 1.4rem;
            }
            
            .final-stats {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .progress-container {
                width: 200px;
                bottom: 10px;
            }
            
            .progress-bar {
                height: 6px;
            }
        }
        
        /* OPTIMISATIONS ORIENTATION PAYSAGE */
        @media (max-height: 500px) and (orientation: landscape) {
            .game-header {
                margin-bottom: 20px;
            }
            
            .game-title {
                font-size: 1.8rem;
                margin-bottom: 10px;
            }
            
            .game-subtitle {
                font-size: 0.9rem;
                margin-bottom: 15px;
            }
            
            .difficulty-selector {
                margin: 15px 0;
            }
            
            .difficulty-buttons {
                flex-direction: row;
                gap: 10px;
            }
            
            .difficulty-btn {
                min-width: 100px;
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            
            .ui-top {
                padding: 8px 15px;
            }
            
            .progress-container {
                bottom: 5px;
                width: 250px;
            }
        }
        
        /* OPTIMISATIONS ÉCRANS HAUTE DENSITÉ */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            body {
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }
            
            .game-title {
                text-rendering: optimizeLegibility;
            }
        }
        
        /* AMÉLIORATIONS ACCESSIBILITÉ MOBILE */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .game-title {
                animation: none;
            }
            
            .game-btn.primary {
                animation: none;
            }
        }
        
        /* OPTIMISATIONS CONTRASTE ÉLEVÉ */
        @media (prefers-contrast: high) {
            .score-display, .level-display, .lives-display {
                border: 2px solid white;
                background: rgba(0, 0, 0, 0.9);
            }
            
            .game-btn {
                border: 2px solid white;
            }
        }
        
        /* SUPPORT MODE SOMBRE NATIF */
        @media (prefers-color-scheme: dark) {
            :root {
                --text-color: #ffffff;
                --bg-primary: #000000;
                --bg-secondary: #1a1a1a;
            }
        }
        
        /* Debug styles - maintenu pour le développement */
        
        /* STYLES LEADERBOARD */
        .leaderboard-content {
            background: rgba(20, 20, 20, 0.95);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .leaderboard-list {
            margin: 30px 0;
        }
        
        .leaderboard-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .leaderboard-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .leaderboard-item.current-player {
            background: rgba(78, 205, 196, 0.2);
            border-color: #4ecdc4;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 10px rgba(78, 205, 196, 0.3); }
            50% { box-shadow: 0 0 20px rgba(78, 205, 196, 0.6); }
        }
        
        .leaderboard-rank {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
            width: 50px;
            text-align: center;
        }
        
        .leaderboard-rank.first { color: #ffd700; }
        .leaderboard-rank.second { color: #c0c0c0; }
        .leaderboard-rank.third { color: #cd7f32; }
        
        .leaderboard-info {
            flex: 1;
            text-align: left;
            margin-left: 20px;
        }
        
        .leaderboard-pseudo {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4ecdc4;
            margin-bottom: 5px;
        }
        
        .leaderboard-details {
            font-size: 0.9rem;
            color: #888;
        }
        
        .leaderboard-score {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff6b6b;
            text-align: right;
            min-width: 80px;
        }
        
        .leaderboard-input {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .leaderboard-input h3 {
            color: #4ecdc4;
            margin-bottom: 15px;
        }
        
        .leaderboard-input input {
            width: 100%;
            max-width: 300px;
            padding: 10px 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .leaderboard-input input:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.5);
        }
        
        .leaderboard-input input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .leaderboard-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        /* STYLES ONGLETS MENU PAUSE */
        .pause-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .tab-btn {
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            padding: 10px 20px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        
        .tab-btn:hover {
            color: rgba(255, 255, 255, 0.8);
        }
        
        .tab-btn.active {
            color: #4ecdc4;
            border-bottom-color: #4ecdc4;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .game-rules {
            text-align: left;
            max-height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .game-rules h3 {
            color: #4ecdc4;
            margin-bottom: 10px;
            margin-top: 20px;
        }
        
        .game-rules h3:first-child {
            margin-top: 0;
        }
        
        .game-rules p {
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .game-rules ul {
            margin-bottom: 15px;
            padding-left: 20px;
        }
        
        .game-rules li {
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .level-info {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .level-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: bold;
            border: 1px solid rgba(78, 205, 196, 0.3);
        }
        
        /* RESPONSIVE POUR LEADERBOARD */
        @media (max-width: 768px) {
            .leaderboard-content {
                padding: 20px;
                max-width: 95%;
            }
            
            .leaderboard-item {
                flex-direction: column;
                text-align: center;
                padding: 15px;
            }
            
            .leaderboard-info {
                margin: 10px 0;
                text-align: center;
            }
            
            .leaderboard-score {
                text-align: center;
                margin-top: 5px;
            }
            
            .pause-tabs {
                flex-direction: column;
                gap: 5px;
            }
            
            .game-rules {
                max-height: 300px;
                padding: 15px;
            }
            
            .level-info {
                flex-direction: column;
                gap: 5px;
            }
        }
        
        @media (max-width: 480px) {
            .leaderboard-content {
                padding: 15px;
            }
            
            .leaderboard-item {
                padding: 10px;
            }
            
            .leaderboard-pseudo {
                font-size: 1rem;
            }
            
            .leaderboard-score {
                font-size: 1.2rem;
            }
            
            .game-rules {
                max-height: 250px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Écran de démarrage -->
    <div id="start-screen" class="game-screen active">
        <div class="game-header">
            <h1 class="game-title">
                <span class="title-icon">⚔️</span>
                Verbe Slicer
            </h1>
            <p class="game-subtitle">Maîtrisez les verbes irréguliers français !</p>
        </div>

        <div style="color: white; text-align: center; margin: 20px;">
            <p>🎯 <strong>Objectif :</strong> Cliquez sur les verbes irréguliers qui tombent</p>
            <p>⚡ <strong>Contrôles :</strong> Clic pour trancher, Espace pour pause</p>
            <p>📈 <strong>Progression :</strong> 5 niveaux de difficulté croissante</p>
        </div>

        <div class="difficulty-selector">
            <h3>Choisissez votre difficulté :</h3>
            <div class="difficulty-buttons">
                <button class="difficulty-btn" data-difficulty="facile">
                    <span class="difficulty-icon">🌱</span>
                    <span class="difficulty-name">Facile</span>
                </button>
                <button class="difficulty-btn active" data-difficulty="normal">
                    <span class="difficulty-icon">⚡</span>
                    <span class="difficulty-name">Normal</span>
                </button>
                <button class="difficulty-btn" data-difficulty="difficile">
                    <span class="difficulty-icon">🔥</span>
                    <span class="difficulty-name">Difficile</span>
                </button>
            </div>
        </div>

        <button id="start-game-btn" class="game-btn primary">
            <span class="btn-icon">🚀</span>
            Commencer l'aventure
        </button>
        
        <button id="main-leaderboard-btn" class="game-btn secondary">
            <span class="btn-icon">🏆</span>
            Voir le classement
        </button>
    </div>

    <!-- Écran de jeu -->
    <div id="game-screen" class="game-screen">
        <div class="game-ui">
            <div class="ui-top">
                <div class="score-display">
                    <span class="score-label">Score</span>
                    <span id="score" class="score-value">0</span>
                </div>
                
                <div class="level-display">
                    <span class="level-label">Niveau</span>
                    <span id="level" class="level-value">1</span>
                    <span id="level-name" class="level-name">Infinitifs</span>
                </div>

                <div class="lives-display">
                    <span class="lives-label">Vies</span>
                    <div id="lives" class="lives-hearts">
                        <span class="heart">❤️</span>
                        <span class="heart">❤️</span>
                        <span class="heart">❤️</span>
                        <span class="heart">❤️</span>
                        <span class="heart">❤️</span>
                    </div>
                </div>

                <button id="pause-btn" class="ui-btn">⏸️</button>
            </div>

            <div class="ui-bottom">
                <div class="progress-container">
                    <div class="progress-label">Progression vers le niveau suivant</div>
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill"></div>
                    </div>
                    <div id="progress-text" class="progress-text">0 / 25</div>
                </div>
            </div>
        </div>

        <canvas id="game-canvas"></canvas>
        <div id="particles-container"></div>
        <div id="floating-texts"></div>
    </div>

    <!-- Écran de pause -->
    <div id="pause-screen" class="game-screen overlay">
        <div class="pause-content">
            <h2>⏸️ Jeu en pause</h2>
            
            <!-- Onglets -->
            <div class="pause-tabs">
                <button id="stats-tab" class="tab-btn active" data-tab="stats">📊 Statistiques</button>
                <button id="rules-tab" class="tab-btn" data-tab="rules">📋 Règles du jeu</button>
            </div>
            
            <!-- Contenu des statistiques -->
            <div id="stats-content" class="tab-content active">
                <div class="pause-stats">
                    <div class="stat-item">
                        <span class="stat-label">Score actuel</span>
                        <span id="pause-score" class="stat-value">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Niveau</span>
                        <span id="pause-level" class="stat-value">1</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Précision</span>
                        <span id="pause-accuracy" class="stat-value">100%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Progression</span>
                        <span id="pause-progress" class="stat-value">0%</span>
                        <span id="pause-progress-text" class="stat-label">0 / 25</span>
                    </div>
                </div>
            </div>
            
            <!-- Contenu des règles -->
            <div id="rules-content" class="tab-content">
                <div class="game-rules">
                    <h3>🎯 Objectif du jeu</h3>
                    <p>Cliquez <strong>uniquement</strong> sur les verbes irréguliers qui tombent pour marquer des points.</p>
                    
                    <h3>📜 Règles</h3>
                    <ul>
                        <li>✅ <strong>Bon clic</strong> : Verbe irrégulier → +1 point + récupération de vie</li>
                        <li>❌ <strong>Mauvais clic</strong> : Verbe régulier → -1 vie</li>
                        <li>💔 <strong>Verbe raté</strong> : Verbe irrégulier qui tombe → -1 vie</li>
                    </ul>
                    
                    <h3>🎮 Contrôles</h3>
                    <ul>
                        <li>🖱️ <strong>Clic</strong> : Trancher un verbe</li>
                        <li>⏸️ <strong>Espace</strong> : Mettre en pause</li>
                        <li>🔄 <strong>R</strong> : Redémarrer</li>
                    </ul>
                    
                    <h3>📈 Progression</h3>
                    <p>Progressez à travers 6 niveaux :</p>
                    <div class="level-info">
                        <span class="level-badge">1</span> Infinitifs
                        <span class="level-badge">2</span> Participes passés
                        <span class="level-badge">3</span> Futur
                        <span class="level-badge">4</span> Imparfait
                        <span class="level-badge">5</span> Subjonctif
                        <span class="level-badge">6</span> Conditionnel
                    </div>
                </div>
            </div>
            
            <div class="pause-buttons">
                <button id="resume-btn" class="game-btn primary">
                    <span class="btn-icon">▶️</span>
                    Reprendre
                </button>
                <button id="restart-btn" class="game-btn secondary">
                    <span class="btn-icon">🔄</span>
                    Redémarrer
                </button>
                <button id="quit-btn" class="game-btn">
                    <span class="btn-icon">🏠</span>
                    Quitter
                </button>
                <button id="menu-games-btn" class="game-btn">
                    <span class="btn-icon">🎮</span>
                    Menu des jeux
                </button>
            </div>
        </div>
    </div>

    <!-- Écran de fin -->
    <div id="game-over-screen" class="game-screen overlay">
        <div class="game-over-content">
            <h2 id="game-over-title">🎯 Partie terminée !</h2>
            
            <div class="final-stats">
                <div class="stat-card">
                    <span class="stat-icon">🏆</span>
                    <span class="stat-label">Score final</span>
                    <span id="final-score" class="stat-value">0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">📊</span>
                    <span class="stat-label">Niveau atteint</span>
                    <span id="final-level" class="stat-value">1</span>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">🎯</span>
                    <span class="stat-label">Précision</span>
                    <span id="final-accuracy" class="stat-value">100%</span>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">⚔️</span>
                    <span class="stat-label">Verbes tranchés</span>
                    <span id="verbs-sliced" class="stat-value">0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">⏱️</span>
                    <span class="stat-label">Temps de jeu</span>
                    <span id="game-time" class="stat-value">0:00</span>
                </div>
                <div class="stat-card">
                    <span class="stat-icon">🔥</span>
                    <span class="stat-label">Meilleure série</span>
                    <span id="best-streak" class="stat-value">0</span>
                </div>
            </div>

            <div id="performance-message" class="performance-message"></div>

            <!-- Saisie du pseudo pour le leaderboard -->
            <div id="leaderboard-input" class="leaderboard-input" style="display: none;">
                <h3>🎉 Nouveau record ! Entrez votre pseudo :</h3>
                <input type="text" id="player-pseudo" placeholder="Votre pseudo..." maxlength="15">
                <button id="save-score-btn" class="game-btn primary">
                    <span class="btn-icon">💾</span>
                    Enregistrer
                </button>
            </div>

            <div class="game-over-buttons">
                <button id="play-again-btn" class="game-btn primary">
                    <span class="btn-icon">🔄</span>
                    Rejouer
                </button>
                <button id="leaderboard-btn" class="game-btn secondary">
                    <span class="btn-icon">🏆</span>
                    Classement
                </button>
                <button id="back-to-menu-btn" class="game-btn secondary">
                    <span class="btn-icon">🏠</span>
                    Menu principal
                </button>
            </div>
        </div>
    </div>

    <!-- Écran de leaderboard -->
    <div id="leaderboard-screen" class="game-screen overlay">
        <div class="leaderboard-content">
            <h2>🏆 Classement des Maîtres Verbes</h2>
            
            <div id="leaderboard-list" class="leaderboard-list">
                <!-- Les scores seront chargés dynamiquement -->
            </div>

            <div class="leaderboard-buttons">
                <button id="close-leaderboard-btn" class="game-btn secondary">
                    <span class="btn-icon">🔙</span>
                    Retour
                </button>
            </div>
        </div>
    </div>

    <script>
        // Version modifiée du jeu qui force les données fallback
        class VerbeSlicerSimple {
            constructor() {
                console.log('🎮 Initialisation Verbe Slicer Simple...');
                
                this.canvas = null;
                this.ctx = null;
                this.gameState = 'menu';
                this.difficulty = 'normal';
                
                // FORCE les données intégrées immédiatement - BASE ENRICHIE
                this.verbesData = {
                    verbesIrreguliers: {
                        infinitif: [
                            'être', 'avoir', 'aller', 'faire', 'dire', 'pouvoir', 'voir', 'savoir', 
                            'vouloir', 'venir', 'prendre', 'mettre', 'devoir', 'partir', 'tenir',
                            'sortir', 'sentir', 'vivre', 'mourir', 'ouvrir', 'suivre', 'courir',
                            'servir', 'dormir', 'mentir', 'croire', 'boire', 'lire', 'écrire', 'connaître'
                        ],
                        participe_passe: [
                            'été', 'eu', 'allé', 'fait', 'dit', 'pu', 'vu', 'su', 
                            'voulu', 'venu', 'pris', 'mis', 'dû', 'parti', 'tenu',
                            'sorti', 'senti', 'vécu', 'mort', 'ouvert', 'suivi', 'couru',
                            'servi', 'dormi', 'menti', 'cru', 'bu', 'lu', 'écrit', 'connu'
                        ],
                        futur: [
                            'serai', 'aurai', 'irai', 'ferai', 'dirai', 'pourrai', 'verrai', 'saurai', 
                            'voudrai', 'viendrai', 'prendrai', 'mettrai', 'devrai', 'partirai', 'tiendrai',
                            'sortirai', 'sentirai', 'vivrai', 'mourrai', 'ouvrirai', 'suivrai', 'courrai',
                            'servirai', 'dormirai', 'mentirai', 'croirai', 'boirai', 'lirai', 'écrirai', 'connaîtrai'
                        ],
                        imparfait: [
                            'étais', 'avais', 'allais', 'faisais', 'disais', 'pouvais', 'voyais', 'savais', 
                            'voulais', 'venais', 'prenais', 'mettais', 'devais', 'partais', 'tenais',
                            'sortais', 'sentais', 'vivais', 'mourais', 'ouvrais', 'suivais', 'courais',
                            'servais', 'dormais', 'mentais', 'croyais', 'buvais', 'lisais', 'écrivais', 'connaissais'
                        ],
                        subjonctif: [
                            'sois', 'aies', 'ailles', 'fasses', 'dises', 'puisses', 'voies', 'saches', 
                            'veuilles', 'viennes', 'prennes', 'mettes', 'doives', 'partes', 'tiennes',
                            'sortes', 'sentes', 'vives', 'meures', 'ouvres', 'suives', 'coures',
                            'serves', 'dormes', 'mentes', 'croies', 'boives', 'lises', 'écrives', 'connaisses'
                        ],
                        conditionnel: [
                            'serais', 'aurais', 'irais', 'ferais', 'dirais', 'pourrais', 'verrais', 'saurais', 
                            'voudrais', 'viendrais', 'prendrais', 'mettrais', 'devrais', 'partirais', 'tiendrais',
                            'sortirais', 'sentirais', 'vivrais', 'mourrais', 'ouvrirais', 'suivrais', 'courrais',
                            'servirais', 'dormirais', 'mentirais', 'croirais', 'boirais', 'lirais', 'écrirais', 'connaîtrais'
                        ]
                    },
                    motsDivers: [
                        // Verbes réguliers infinitifs
                        'parler', 'aimer', 'donner', 'porter', 'arriver', 'rester', 'entrer', 'montrer',
                        'passer', 'regarder', 'trouver', 'appeler', 'demander', 'garder', 'attendre',
                        'chanter', 'danser', 'jouer', 'manger', 'travailler', 'étudier', 'marcher',
                        'chercher', 'écouter', 'habiter', 'finir', 'choisir', 'réussir', 'grandir',
                        // Participes passés réguliers
                        'parlé', 'aimé', 'donné', 'porté', 'arrivé', 'resté', 'entré', 'montré',
                        'passé', 'regardé', 'trouvé', 'appelé', 'demandé', 'gardé', 'attendu',
                        'chanté', 'dansé', 'joué', 'mangé', 'travaillé', 'étudié', 'marché',
                        'cherché', 'écouté', 'habité', 'fini', 'choisi', 'réussi', 'grandi',
                        // Conditionnels réguliers
                        'parlerais', 'aimerais', 'donnerais', 'porterais', 'arriverais', 'resterais', 'entrerais', 'montrerais',
                        'passerais', 'regarderais', 'trouverais', 'appellerais', 'demanderais', 'garderais', 'attendrais',
                        'chanterais', 'danserais', 'jouerais', 'mangerais', 'travaillerais', 'étudierais', 'marcherais',
                        'chercherais', 'écouterais', 'habiterais', 'finirais', 'choisirais', 'réussirais', 'grandirais'
                    ]
                };
                console.log('📊 Données fallback enrichies chargées - Mode autonome confirmé');
                this.currentVerbs = [];
                this.isDataLoaded = true; // FORCE à true
                
                // Stats de jeu
                this.score = 0;
                this.level = 1;
                this.lives = 5;
                this.maxLives = 5;
                this.verbsSliced = 0;
                this.totalClicks = 0;
                this.correctClicks = 0;
                this.currentStreak = 0;
                this.bestStreak = 0;
                this.gameStartTime = 0;
                this.gameTime = 0;
                
                console.log('🎮 Stats initiales:', {
                    lives: this.lives,
                    maxLives: this.maxLives,
                    score: this.score
                });
                
                // Paramètres de jeu
                this.gameSpeed = 60;
                this.spawnRate = 0.03;
                this.wordSpeed = 1;
                this.maxWords = 8;
                this.lastSpawnTime = 0;
                this.spawnInterval = 1000;
                
                // NOUVEAU : Système de timing pour les verbes irréguliers
                this.minIrregularInterval = 3000; // 3 secondes minimum entre verbes irréguliers
                this.lastIrregularSpawnTime = 0;
                
                // NOUVEAU : Système de leaderboard
                this.leaderboardData = [];
                this.currentPlayerScore = null;
                this.previousScreen = 'start-screen'; // Pour revenir au bon écran depuis le leaderboard
                
                // Niveaux - SEUILS AJUSTÉS POUR PROGRESSION PLUS RAPIDE
                this.levels = [
                    { name: 'Infinitifs', threshold: 0, verbType: 'infinitif', color: '#3498db' },
                    { name: 'Participes passés', threshold: 10, verbType: 'participe_passe', color: '#9b59b6' },
                    { name: 'Futur', threshold: 25, verbType: 'futur', color: '#e67e22' },
                    { name: 'Imparfait', threshold: 45, verbType: 'imparfait', color: '#e74c3c' },
                    { name: 'Subjonctif', threshold: 70, verbType: 'subjonctif', color: '#f39c12' },
                    { name: 'Conditionnel', threshold: 100, verbType: 'conditionnel', color: '#8e44ad' }
                ];
                
                this.difficultySettings = {
                    facile: { speedMultiplier: 0.8, spawnMultiplier: 0.8, maxWords: 5 },
                    normal: { speedMultiplier: 1.0, spawnMultiplier: 1.0, maxWords: 10 },
                    difficile: { speedMultiplier: 2, spawnMultiplier: 2, maxWords: 20 }
                };
                
                // Effets visuels
                this.fallingWords = [];
                this.particles = [];
                this.floatingTexts = [];
                this.sliceEffects = [];
                
                this.init();
            }
            
            async init() {
                try {
                                    this.setupEventListeners();
                
                this.initializeCurrentVerbs();
                
                this.setupCanvas();
                
                // NOUVEAU : Charger le leaderboard au démarrage
                this.loadLeaderboard();
                
                console.log('✅ Verbe Slicer Simple initialisé !');
            } catch (error) {
                console.error('❌ Erreur:', error);
            }
        }
            
            setupEventListeners() {
                const startBtn = document.getElementById('start-game-btn');
                const mainLeaderboardBtn = document.getElementById('main-leaderboard-btn');
                if (startBtn) {
                    startBtn.addEventListener('click', () => this.startGame());
                }
                if (mainLeaderboardBtn) {
                    mainLeaderboardBtn.addEventListener('click', () => this.showLeaderboard());
                }
                
                const difficultyBtns = document.querySelectorAll('.difficulty-btn');
                difficultyBtns.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                        e.target.closest('.difficulty-btn').classList.add('active');
                        this.difficulty = e.target.closest('.difficulty-btn').dataset.difficulty;
                    });
                });
                
                const pauseBtn = document.getElementById('pause-btn');
                const resumeBtn = document.getElementById('resume-btn');
                const restartBtn = document.getElementById('restart-btn');
                const quitBtn = document.getElementById('quit-btn');
                const playAgainBtn = document.getElementById('play-again-btn');
                const backToMenuBtn = document.getElementById('back-to-menu-btn');
                const menuGamesBtn = document.getElementById('menu-games-btn');
                
                // NOUVEAUX : Boutons leaderboard
                const leaderboardBtn = document.getElementById('leaderboard-btn');
                const saveScoreBtn = document.getElementById('save-score-btn');
                const closeLeaderboardBtn = document.getElementById('close-leaderboard-btn');
                
                // NOUVEAUX : Onglets menu pause
                const statsTab = document.getElementById('stats-tab');
                const rulesTab = document.getElementById('rules-tab');
                
                if (pauseBtn) pauseBtn.addEventListener('click', () => this.togglePause());
                if (resumeBtn) resumeBtn.addEventListener('click', () => this.togglePause());
                if (restartBtn) restartBtn.addEventListener('click', () => this.startGame());
                if (quitBtn) quitBtn.addEventListener('click', () => this.quitToMenu());
                if (playAgainBtn) playAgainBtn.addEventListener('click', () => this.startGame());
                if (backToMenuBtn) backToMenuBtn.addEventListener('click', () => this.quitToMenu());
                if (menuGamesBtn) menuGamesBtn.addEventListener('click', () => this.goToGamesMenu());
                
                // NOUVEAUX : Event listeners leaderboard
                if (leaderboardBtn) leaderboardBtn.addEventListener('click', () => this.showLeaderboard());
                if (saveScoreBtn) saveScoreBtn.addEventListener('click', () => this.savePlayerScore());
                if (closeLeaderboardBtn) closeLeaderboardBtn.addEventListener('click', () => this.closeLeaderboard());
                
                // NOUVEAUX : Event listeners onglets
                if (statsTab) statsTab.addEventListener('click', () => this.switchTab('stats'));
                if (rulesTab) rulesTab.addEventListener('click', () => this.switchTab('rules'));
                
                // NOUVEAU : Event listener pour la saisie du pseudo (Entrée pour valider)
                const pseudoInput = document.getElementById('player-pseudo');
                if (pseudoInput) {
                    pseudoInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            this.savePlayerScore();
                        }
                    });
                }
                
                document.addEventListener('keydown', (e) => {
                    switch(e.code) {
                        case 'Space':
                            e.preventDefault();
                            if (this.gameState === 'playing' || this.gameState === 'paused') {
                                this.togglePause();
                            }
                            break;
                        case 'KeyR':
                            if (this.gameState === 'playing' || this.gameState === 'paused') {
                                this.startGame();
                            }
                            break;
                    }
                });
            }
            
            initializeCurrentVerbs() {
                const currentLevel = this.getCurrentLevel();
                const irregularVerbs = this.verbesData.verbesIrreguliers[currentLevel.verbType] || [];
                const regularWords = this.verbesData.motsDivers || [];
                this.currentVerbs = [...irregularVerbs, ...regularWords];
                
                // VÉRIFICATION que nous utilisons bien les données fallback
                console.log(` Verbes initialisés: ${this.currentVerbs.length} mots`);
                console.log(` Niveau ${currentLevel.name} (${currentLevel.verbType}):`);
                console.log(`  - ${irregularVerbs.length} verbes irréguliers: ${irregularVerbs.slice(0, 5).join(', ')}...`);
                console.log(`  - ${regularWords.length} mots réguliers: ${regularWords.slice(0, 5).join(', ')}...`);
                console.log('🔒 SOURCE: Données fallback intégrées (autonome)');
            }
            
            setupCanvas() {
                this.canvas = document.getElementById('game-canvas');
                if (!this.canvas) {
                    throw new Error('Canvas non trouvé');
                }
                
                this.ctx = this.canvas.getContext('2d');
                this.resizeCanvas();
                
                window.addEventListener('resize', () => this.resizeCanvas());
                this.canvas.addEventListener('click', (e) => this.handleClick(e));
            }
            
            resizeCanvas() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }
            
            startGame() {
                console.log('🚀 Démarrage du jeu...');
                
                console.log('🔍 État avant reset:', {
                    lives: this.lives,
                    maxLives: this.maxLives,
                    gameState: this.gameState
                });
                
                this.resetGameStats();
                
                console.log('🔍 État après reset:', {
                    lives: this.lives,
                    maxLives: this.maxLives,
                    gameState: this.gameState
                });
                
                this.initializeCurrentVerbs();
                this.gameState = 'playing';
                this.gameStartTime = Date.now();
                this.lastSpawnTime = Date.now();
                
                console.log('🔍 État final avant showScreen:', {
                    lives: this.lives,
                    gameState: this.gameState,
                    currentVerbs: this.currentVerbs.length
                });
                
                this.showScreen('game-screen');
                
                console.log('🔄 Lancement gameLoop...');
                this.gameLoop();
            }
            
            resetGameStats() {
                console.log('🔄 Réinitialisation des stats...');
                this.score = 0;
                this.level = 1;
                this.lives = this.maxLives; // Assurer que maxLives est bien défini
                this.verbsSliced = 0;
                this.totalClicks = 0;
                this.correctClicks = 0;
                this.currentStreak = 0;
                this.bestStreak = 0;
                this.fallingWords = [];
                this.particles = [];
                this.floatingTexts = [];
                this.sliceEffects = [];
                
                console.log('🔄 Vies après reset:', this.lives, 'maxLives:', this.maxLives);
                
                const settings = this.difficultySettings[this.difficulty];
                this.wordSpeed = 1 * settings.speedMultiplier;
                this.spawnRate = 0.02 * settings.spawnMultiplier;
                this.maxWords = settings.maxWords;
                this.spawnInterval = 1000 / settings.spawnMultiplier;
                
                console.log('🎚️ Paramètres difficulté:', this.difficulty, settings);
                
                this.updateUI();
            }
            
            getCurrentLevel() {
                for (let i = this.levels.length - 1; i >= 0; i--) {
                    if (this.score >= this.levels[i].threshold) {
                        return this.levels[i];
                    }
                }
                return this.levels[0];
            }
            
            gameLoop() {
                if (this.gameState !== 'playing') return;
                
                this.update();
                this.render();
                
                requestAnimationFrame(() => this.gameLoop());
            }
            
            update() {
                this.gameTime = Date.now() - this.gameStartTime;
                
                // DEBUG: Vérifier les vies
                if (this.lives <= 0) {
                    console.log('❌ Game Over détecté, vies:', this.lives);
                    this.gameOver();
                    return;
                }
                
                // Spawn de nouveaux mots
                const now = Date.now();
                if (now - this.lastSpawnTime > this.spawnInterval && this.fallingWords.length < this.maxWords) {
                    this.spawnWord();
                    this.lastSpawnTime = now;
                }
                
                // Mise à jour des mots qui tombent
                this.updateFallingWords();
                this.updateParticles();
                this.updateFloatingTexts();
            }
            
            spawnWord() {
                if (this.currentVerbs.length === 0) return;
                
                const now = Date.now();
                let word, isIrregular;
                let attempts = 0;
                const maxWordAttempts = 20;
                
                // NOUVEAU : Système de timing pour les verbes irréguliers
                do {
                    word = this.currentVerbs[Math.floor(Math.random() * this.currentVerbs.length)];
                    isIrregular = this.isIrregularVerb(word);
                    attempts++;
                    
                    // Si c'est un verbe irrégulier, vérifier le timing
                    if (isIrregular) {
                        const timeSinceLastIrregular = now - this.lastIrregularSpawnTime;
                        if (timeSinceLastIrregular < this.minIrregularInterval) {
                            // Trop tôt pour un verbe irrégulier, essayer un autre mot
                            console.log(`⏰ Verbe irrégulier "${word}" rejeté - délai minimum non respecté (${timeSinceLastIrregular}ms < ${this.minIrregularInterval}ms)`);
                            continue;
                        }
                    }
                    
                    // Mot valide trouvé
                    break;
                    
                } while (attempts < maxWordAttempts);
                
                // Si on n'a pas trouvé de mot valide, prendre un mot régulier
                if (attempts >= maxWordAttempts) {
                    const regularWords = this.currentVerbs.filter(w => !this.isIrregularVerb(w));
                    if (regularWords.length > 0) {
                        word = regularWords[Math.floor(Math.random() * regularWords.length)];
                        isIrregular = false;
                        console.log(`🔄 Fallback vers mot régulier: "${word}"`);
                    } else {
                        console.log(`⚠️ Aucun mot valide trouvé après ${maxWordAttempts} tentatives`);
                        return;
                    }
                }
                
                // Enregistrer le timestamp si c'est un verbe irrégulier
                if (isIrregular) {
                    this.lastIrregularSpawnTime = now;
                    console.log(`📝 Timestamp verbe irrégulier enregistré: ${now}`);
                }
                
                const currentLevel = this.getCurrentLevel();
                
                // AMÉLIORATION : Éviter les spawns trop proches dès le départ
                let attemptCount = 0;
                let spawnX, spawnY;
                const maxAttempts = 10;
                const minDistanceFromOthers = 80; // Distance minimale avec les autres mots
                
                do {
                    spawnX = Math.random() * (this.canvas.width - 200) + 100;
                    spawnY = -50;
                    attemptCount++;
                    
                    // Vérifier la distance avec les autres mots existants
                    let tooClose = false;
                    for (let existingWord of this.fallingWords) {
                        const distance = Math.sqrt(
                            Math.pow(spawnX - existingWord.x, 2) + 
                            Math.pow(spawnY - existingWord.y, 2)
                        );
                        if (distance < minDistanceFromOthers) {
                            tooClose = true;
                            break;
                        }
                    }
                    
                    if (!tooClose) break; // Position valide trouvée
                    
                } while (attemptCount < maxAttempts);
                
                // COULEURS UNIFORMISÉES - Plus de distinction visuelle
                let wordColor = currentLevel.color || '#ffffff'; // Couleur uniforme basée sur le niveau
                
                this.fallingWords.push({
                    text: word,
                    x: spawnX,
                    y: spawnY,
                    speed: this.wordSpeed + Math.random() * 0.5,
                    isIrregular: isIrregular,
                    color: wordColor, // Couleur uniforme
                    rotation: 0,
                    rotationSpeed: (Math.random() - 0.5) * 0.02
                });
                
                console.log(`✨ Mot spawné: "${word}" (${isIrregular ? 'irrégulier' : 'régulier'}) à (${Math.round(spawnX)}, ${Math.round(spawnY)}), tentatives: ${attemptCount} - Couleur uniforme: ${wordColor}`);
            }
            
            isIrregularVerb(word) {
                return Object.values(this.verbesData.verbesIrreguliers).some(verbs => 
                    verbs.includes(word)
                );
            }
            
            updateFallingWords() {
                this.fallingWords.forEach((word, index) => {
                    word.y += word.speed;
                    word.rotation += word.rotationSpeed;
                    
                    // NOUVEAU : Système de répulsion entre les mots pour éviter les superpositions
                    this.applyRepulsionForces(word, index);
                    
                    if (word.y > this.canvas.height + 50) {
                        this.fallingWords.splice(index, 1);
                        if (word.isIrregular) {
                            console.log('💔 Verbe irrégulier raté:', word.text, 'Vies avant:', this.lives);
                            this.loseLife();
                            console.log('💔 Vies après:', this.lives);
                        }
                    }
                });
            }
            
            // NOUVELLE FONCTION : Système de répulsion pour éviter les collisions
            applyRepulsionForces(currentWord, currentIndex) {
                const repulsionRadius = 60; // Distance minimale entre les mots
                const repulsionStrength = 0.5; // Force de répulsion
                
                this.fallingWords.forEach((otherWord, otherIndex) => {
                    if (currentIndex === otherIndex) return; // Ne pas se repousser soi-même
                    
                    // Calculer la distance entre les deux mots
                    const dx = currentWord.x - otherWord.x;
                    const dy = currentWord.y - otherWord.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    // Si les mots sont trop proches, appliquer une force de répulsion
                    if (distance < repulsionRadius && distance > 0) {
                        // Calculer la force de répulsion normalisée
                        const forceX = (dx / distance) * repulsionStrength;
                        const forceY = (dy / distance) * repulsionStrength;
                        
                        // Appliquer la force - les verbes irréguliers ont la priorité
                        if (currentWord.isIrregular && !otherWord.isIrregular) {
                            // Le verbe irrégulier repousse le verbe régulier
                            otherWord.x -= forceX * 2;
                            otherWord.y -= forceY * 0.5; // Moins de force verticale pour ne pas trop perturber la chute
                        } else if (!currentWord.isIrregular && otherWord.isIrregular) {
                            // Le verbe régulier s'écarte du verbe irrégulier
                            currentWord.x += forceX * 2;
                            currentWord.y += forceY * 0.5;
                        } else {
                            // Répulsion mutuelle normale
                            currentWord.x += forceX;
                            otherWord.x -= forceX;
                            // Moins de force verticale pour maintenir la chute naturelle
                            currentWord.y += forceY * 0.3;
                            otherWord.y -= forceY * 0.3;
                        }
                        
                        // S'assurer que les mots restent dans les limites de l'écran
                        const margin = 50;
                        currentWord.x = Math.max(margin, Math.min(this.canvas.width - margin, currentWord.x));
                        otherWord.x = Math.max(margin, Math.min(this.canvas.width - margin, otherWord.x));
                    }
                });
            }
            
            handleClick(event) {
                if (this.gameState !== 'playing') return;
                
                const rect = this.canvas.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;
                
                this.totalClicks++;
                
                // AMÉLIORATION MAJEURE : Prioriser les verbes irréguliers lors des clics
                // Créer deux listes : verbes irréguliers et réguliers
                const irregularWords = [];
                const regularWords = [];
                
                this.fallingWords.forEach((word, index) => {
                    if (this.isPointInWord(x, y, word)) {
                        if (word.isIrregular) {
                            irregularWords.push({ word, index });
                        } else {
                            regularWords.push({ word, index });
                        }
                    }
                });
                
                // PRIORITÉ AUX VERBES IRRÉGULIERS : si on peut cliquer sur les deux types,
                // on privilégie toujours le verbe irrégulier
                let targetWord = null;
                let targetIndex = -1;
                let hit = false;
                
                if (irregularWords.length > 0) {
                    // Prendre le premier verbe irrégulier trouvé
                    targetWord = irregularWords[0].word;
                    targetIndex = irregularWords[0].index;
                    hit = true;
                    console.log('🎯 Priorité donnée au verbe irrégulier:', targetWord.text);
                } else if (regularWords.length > 0) {
                    // Sinon prendre le premier verbe régulier
                    targetWord = regularWords[0].word;
                    targetIndex = regularWords[0].index;
                    hit = true;
                    console.log('🎯 Clic sur verbe régulier:', targetWord.text);
                }
                
                if (hit && targetWord && targetIndex >= 0) {
                    this.handleWordClick(targetWord, targetIndex);
                } else {
                    console.log('❌ Clic dans le vide');
                }
            }
            
            isPointInWord(x, y, word) {
                this.ctx.font = '30px Arial';
                const metrics = this.ctx.measureText(word.text);
                const wordWidth = metrics.width;
                const wordHeight = 30;
                
                // CORRECTION MAJEURE : Zones cliquables BEAUCOUP plus grandes pour mobile et desktop
                // Augmentation massive des zones de sécurité
                const extraWidthPadding = 80; // 40px de chaque côté (doublé)
                const extraHeightPadding = 60; // 30px au-dessus et en-dessous (doublé)
                const minClickableWidth = 120; // Largeur minimale augmentée
                const minClickableHeight = 80; // Hauteur minimale augmentée
                
                // Calculer les dimensions finales avec padding massif
                const finalWidth = Math.max(wordWidth + extraWidthPadding, minClickableWidth);
                const finalHeight = Math.max(wordHeight + extraHeightPadding, minClickableHeight);
                
                return x >= word.x - finalWidth/2 && 
                       x <= word.x + finalWidth/2 && 
                       y >= word.y - finalHeight/2 && 
                       y <= word.y + finalHeight/2;
            }
            
            handleWordClick(word, index) {
                this.totalClicks++;
                this.fallingWords.splice(index, 1);
                
                if (word.isIrregular) {
                    // Bon clic sur verbe irrégulier
                    this.score++;
                    this.verbsSliced++;
                    this.correctClicks++;
                    this.currentStreak++;
                    this.bestStreak = Math.max(this.bestStreak, this.currentStreak);
                    
                    // Récupération d'un coeur et affichage du texte combiné
                    let mainText = '+1';
                    if (this.lives < this.maxLives) {
                        this.lives++;
                        mainText = '+1 ❤️'; // Combiner les deux messages en un seul
                        console.log('💚 Coeur récupéré ! Vies actuelles:', this.lives);
                    }
                    
                    // Un seul texte flottant
                    this.addFloatingText(word.x, word.y, mainText, 'success');
                    console.log('✅ Verbe irrégulier tranché:', word.text, 'Score:', this.score);
                    
                    // Vérifier changement de niveau
                    this.checkLevelUp();
                } else {
                    // Mauvais clic sur verbe régulier
                    this.currentStreak = 0;
                    this.loseLife();
                    this.addFloatingText(word.x, word.y, 'Erreur !', 'error');
                    console.log('❌ Erreur: verbe régulier cliqué:', word.text, 'Vies restantes:', this.lives);
                }
                
                this.updateUI();
            }
            
            checkLevelUp() {
                const previousLevel = this.level;
                const currentLevel = this.getCurrentLevel();
                const newLevel = this.levels.indexOf(currentLevel) + 1;
                
                if (newLevel > this.level) {
                    this.level = newLevel;
                    this.initializeCurrentVerbs(); // Recharger les verbes pour le nouveau niveau
                    
                    console.log('🔥 NIVEAU UP !', {
                        previousLevel,
                        newLevel: this.level,
                        currentLevelName: currentLevel.name,
                        score: this.score
                    });
                    
                    // Affichage visuel du niveau up
                    this.showLevelUpEffect();
                }
            }
            
            showLevelUpEffect() {
                const currentLevel = this.getCurrentLevel();
                
                // Créer l'effet de niveau up
                const effectElement = document.createElement('div');
                effectElement.innerHTML = `
                    <div style="
                        position: fixed;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        background: linear-gradient(135deg, ${currentLevel.color}, #ffd700);
                        color: white;
                        padding: 30px 50px;
                        border-radius: 20px;
                        font-size: 2rem;
                        font-weight: bold;
                        text-align: center;
                        z-index: 10000;
                        animation: levelUpPulse 2s ease-out;
                        box-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
                        border: 3px solid #ffd700;
                    ">
                        🎉 NIVEAU ${this.level} 🎉<br>
                        <span style="font-size: 1.2rem; color: #fff;">${currentLevel.name}</span>
                    </div>
                `;
                
                // Ajouter l'animation CSS temporairement
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes levelUpPulse {
                        0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
                        50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
                        100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
                document.body.appendChild(effectElement);
                
                // Supprimer l'effet après l'animation
                setTimeout(() => {
                    document.body.removeChild(effectElement);
                    document.head.removeChild(style);
                }, 2000);
            }
            
            loseLife() {
                this.lives--;
                console.log('💔 Vie perdue, vies restantes:', this.lives);
                this.updateLivesDisplay();
                if (this.lives <= 0) {
                    console.log('💀 Plus de vies, Game Over');
                    this.gameOver();
                }
            }
            
            addFloatingText(x, y, text, type) {
                this.floatingTexts.push({
                    x: x, y: y, text: text, type: type,
                    life: 1, decay: 0.015, vy: -2
                });
            }
            
            updateParticles() {
                this.particles.forEach((particle, index) => {
                    particle.life -= particle.decay;
                    if (particle.life <= 0) {
                        this.particles.splice(index, 1);
                    }
                });
            }
            
            updateFloatingTexts() {
                this.floatingTexts.forEach((text, index) => {
                    text.y += text.vy;
                    text.life -= text.decay;
                    if (text.life <= 0) {
                        this.floatingTexts.splice(index, 1);
                    }
                });
            }
            
            render() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.renderFallingWords();
                this.renderFloatingTexts();
            }
            
            renderFallingWords() {
                this.fallingWords.forEach(word => {
                    this.ctx.save();
                    this.ctx.translate(word.x, word.y);
                    this.ctx.rotate(word.rotation);
                    
                    // Ombre portée uniforme
                    this.ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
                    this.ctx.font = 'bold 30px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.fillText(word.text, 2, 2);
                    
                    // Texte principal uniforme - PLUS DE DISTINCTION VISUELLE
                    this.ctx.fillStyle = word.color;
                    this.ctx.fillText(word.text, 0, 0);
                    
                    // SUPPRESSION de tous les effets visuels distinctifs
                    // Plus d'émojis, plus de halos, plus de bordures différentes
                    // Tous les mots ont la même apparence pour augmenter la difficulté
                    
                    this.ctx.restore();
                });
            }
            
            renderFloatingTexts() {
                this.floatingTexts.forEach(text => {
                    this.ctx.save();
                    this.ctx.globalAlpha = text.life;
                    this.ctx.font = 'bold 24px Arial';
                    this.ctx.textAlign = 'center';
                    
                    this.ctx.fillStyle = text.type === 'success' ? '#27ae60' : '#e74c3c';
                    this.ctx.strokeStyle = 'rgba(0, 0, 0, 0.5)';
                    this.ctx.lineWidth = 3;
                    this.ctx.strokeText(text.text, text.x, text.y);
                    this.ctx.fillText(text.text, text.x, text.y);
                    
                    this.ctx.restore();
                });
            }
            
            updateUI() {
                const scoreEl = document.getElementById('score');
                const levelEl = document.getElementById('level');
                const levelNameEl = document.getElementById('level-name');
                
                if (scoreEl) scoreEl.textContent = this.score;
                if (levelEl) levelEl.textContent = this.level;
                if (levelNameEl) levelNameEl.textContent = this.getCurrentLevel().name;
                
                this.updateLivesDisplay();
                this.updateProgressBar();
            }
            
            updateLivesDisplay() {
                const hearts = document.querySelectorAll('.heart');
                console.log('💖 Mise à jour affichage vies:', this.lives, 'coeurs trouvés:', hearts.length);
                hearts.forEach((heart, index) => {
                    if (index < this.lives) {
                        heart.classList.remove('lost');
                    } else {
                        heart.classList.add('lost');
                    }
                });
            }
            
            updateProgressBar() {
                const currentLevel = this.getCurrentLevel();
                const currentLevelIndex = this.levels.indexOf(currentLevel);
                const nextLevel = this.levels[currentLevelIndex + 1];
                
                if (nextLevel) {
                    const pointsInCurrentLevel = this.score - currentLevel.threshold;
                    const pointsNeededForNext = nextLevel.threshold - currentLevel.threshold;
                    const progressPercentage = Math.min((pointsInCurrentLevel / pointsNeededForNext) * 100, 100);
                    
                    const progressFill = document.getElementById('progress-fill');
                    const progressText = document.getElementById('progress-text');
                    
                    if (progressFill) {
                        progressFill.style.width = progressPercentage + '%';
                    }
                    
                    if (progressText) {
                        progressText.textContent = `${pointsInCurrentLevel} / ${pointsNeededForNext}`;
                    }
                    
                    console.log('🔄 Progression mise à jour:', {
                        currentLevel: currentLevel.name,
                        score: this.score,
                        pointsInCurrentLevel,
                        pointsNeededForNext,
                        percentage: progressPercentage.toFixed(1) + '%'
                    });
                } else {
                    // Niveau maximum atteint
                    const progressFill = document.getElementById('progress-fill');
                    const progressText = document.getElementById('progress-text');
                    
                    if (progressFill) {
                        progressFill.style.width = '100%';
                    }
                    
                    if (progressText) {
                        progressText.textContent = 'Niveau MAX';
                    }
                    
                    console.log('🏆 Niveau maximum atteint !');
                }
            }
            
            togglePause() {
                if (this.gameState === 'playing') {
                    this.gameState = 'paused';
                    this.updatePauseStats();
                    this.showScreen('pause-screen');
                } else if (this.gameState === 'paused') {
                    this.gameState = 'playing';
                    this.showScreen('game-screen');
                    this.gameLoop();
                }
            }
            
            updatePauseStats() {
                const accuracy = this.totalClicks > 0 ? Math.round((this.correctClicks / this.totalClicks) * 100) : 100;
                
                // Mise à jour des stats de pause
                const pauseScore = document.getElementById('pause-score');
                const pauseLevel = document.getElementById('pause-level');
                const pauseAccuracy = document.getElementById('pause-accuracy');
                const pauseProgress = document.getElementById('pause-progress');
                const pauseProgressText = document.getElementById('pause-progress-text');
                
                if (pauseScore) pauseScore.textContent = this.score;
                if (pauseLevel) pauseLevel.textContent = this.level;
                if (pauseAccuracy) pauseAccuracy.textContent = accuracy + '%';
                
                // Calcul de la progression
                const currentLevel = this.getCurrentLevel();
                const currentLevelIndex = this.levels.indexOf(currentLevel);
                const nextLevel = this.levels[currentLevelIndex + 1];
                
                if (nextLevel) {
                    const pointsInCurrentLevel = this.score - currentLevel.threshold;
                    const pointsNeededForNext = nextLevel.threshold - currentLevel.threshold;
                    const progressPercentage = Math.min((pointsInCurrentLevel / pointsNeededForNext) * 100, 100);
                    
                    if (pauseProgress) pauseProgress.textContent = Math.round(progressPercentage) + '%';
                    if (pauseProgressText) pauseProgressText.textContent = `${pointsInCurrentLevel} / ${pointsNeededForNext}`;
                } else {
                    if (pauseProgress) pauseProgress.textContent = '100%';
                    if (pauseProgressText) pauseProgressText.textContent = 'Niveau MAX';
                }
            }
            
            quitToMenu() {
                this.gameState = 'menu';
                this.showScreen('start-screen');
            }
            
            gameOver() {
                this.gameState = 'gameOver';
                this.updateFinalStats();
                this.showScreen('game-over-screen');
            }
            
            updateFinalStats() {
                const accuracy = this.totalClicks > 0 ? Math.round((this.correctClicks / this.totalClicks) * 100) : 100;
                const gameTimeSeconds = Math.floor(this.gameTime / 1000);
                const minutes = Math.floor(gameTimeSeconds / 60);
                const seconds = gameTimeSeconds % 60;
                
                document.getElementById('final-score').textContent = this.score;
                document.getElementById('final-level').textContent = this.level;
                document.getElementById('final-accuracy').textContent = accuracy + '%';
                document.getElementById('verbs-sliced').textContent = this.verbsSliced;
                document.getElementById('game-time').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                document.getElementById('best-streak').textContent = this.bestStreak;
                
                // NOUVEAU : Vérifier si c'est un record pour le leaderboard
                this.currentPlayerScore = {
                    score: this.score,
                    level: this.level,
                    accuracy: accuracy,
                    date: new Date().toISOString().split('T')[0],
                    difficulty: this.difficulty,
                    gameTime: `${minutes}:${seconds.toString().padStart(2, '0')}`,
                    verbsSliced: this.verbsSliced
                };
                
                this.checkForNewRecord();
            }
            
            // NOUVELLES FONCTIONS LEADERBOARD
            async loadLeaderboard() {
                try {
                    const response = await fetch('./leaderboard.json');
                    if (!response.ok) {
                        throw new Error('Erreur lors du chargement du leaderboard');
                    }
                    const data = await response.json();
                    this.leaderboardData = data.scores || [];
                    console.log('📊 Leaderboard chargé:', this.leaderboardData.length, 'scores');
                } catch (error) {
                    console.warn('⚠️ Impossible de charger le leaderboard:', error);
                    // Données par défaut si le fichier n'existe pas
                    this.leaderboardData = [];
                }
            }
            
            checkForNewRecord() {
                this.loadLeaderboard().then(() => {
                    const isNewRecord = this.isNewRecord(this.currentPlayerScore.score);
                    const leaderboardInput = document.getElementById('leaderboard-input');
                    
                    if (isNewRecord && leaderboardInput) {
                        leaderboardInput.style.display = 'block';
                        console.log('🎉 Nouveau record détecté ! Score:', this.currentPlayerScore.score);
                    }
                });
            }
            
            isNewRecord(score) {
                // Vérifier si le score mérite d'être dans le top 10
                if (this.leaderboardData.length < 10) {
                    return true; // Moins de 10 scores, toujours accepter
                }
                
                // Vérifier si le score est meilleur que le plus faible du top 10
                const lowestScore = Math.min(...this.leaderboardData.map(s => s.score));
                return score > lowestScore;
            }
            
            async savePlayerScore() {
                const pseudoInput = document.getElementById('player-pseudo');
                const pseudo = pseudoInput.value.trim();
                
                if (!pseudo) {
                    alert('Veuillez entrer un pseudo !');
                    return;
                }
                
                if (pseudo.length > 15) {
                    alert('Le pseudo ne peut pas dépasser 15 caractères !');
                    return;
                }
                
                // Ajouter le pseudo au score actuel
                this.currentPlayerScore.pseudo = pseudo;
                
                // Ajouter le nouveau score
                this.leaderboardData.push(this.currentPlayerScore);
                
                // Trier par score décroissant
                this.leaderboardData.sort((a, b) => b.score - a.score);
                
                // Garder seulement le top 10
                this.leaderboardData = this.leaderboardData.slice(0, 10);
                
                try {
                    // Sauvegarder dans le localStorage comme fallback
                    localStorage.setItem('verbe-slicer-leaderboard', JSON.stringify(this.leaderboardData));
                    console.log('💾 Score sauvegardé dans localStorage');
                    
                    // Cacher l'input et afficher un message de confirmation
                    const leaderboardInput = document.getElementById('leaderboard-input');
                    if (leaderboardInput) {
                        leaderboardInput.style.display = 'none';
                    }
                    
                    // Afficher une notification
                    alert(`🎉 Score enregistré ! Félicitations ${pseudo} !`);
                    
                } catch (error) {
                    console.error('❌ Erreur lors de la sauvegarde:', error);
                    alert('Erreur lors de la sauvegarde du score');
                }
            }
            
            showLeaderboard() {
                // Enregistrer l'écran actuel pour pouvoir y revenir
                if (this.gameState === 'gameOver') {
                    this.previousScreen = 'game-over-screen';
                } else {
                    this.previousScreen = 'start-screen';
                }
                
                this.loadLeaderboard().then(() => {
                    this.displayLeaderboard();
                    this.showScreen('leaderboard-screen');
                });
            }
            
            displayLeaderboard() {
                const leaderboardList = document.getElementById('leaderboard-list');
                if (!leaderboardList) return;
                
                // Charger du localStorage si disponible
                const savedScores = localStorage.getItem('verbe-slicer-leaderboard');
                if (savedScores) {
                    try {
                        const parsedScores = JSON.parse(savedScores);
                        // Fusionner avec les scores existants
                        const allScores = [...this.leaderboardData, ...parsedScores];
                        // Supprimer les doublons et trier
                        const uniqueScores = allScores.filter((score, index, arr) => 
                            arr.findIndex(s => s.pseudo === score.pseudo && s.score === score.score) === index
                        );
                        uniqueScores.sort((a, b) => b.score - a.score);
                        this.leaderboardData = uniqueScores.slice(0, 10);
                    } catch (error) {
                        console.warn('⚠️ Erreur lors du parsing du localStorage:', error);
                    }
                }
                
                if (this.leaderboardData.length === 0) {
                    leaderboardList.innerHTML = '<p style="color: #888; padding: 20px;">Aucun score enregistré pour le moment.<br>Soyez le premier à établir un record !</p>';
                    return;
                }
                
                let html = '';
                this.leaderboardData.forEach((scoreData, index) => {
                    const rank = index + 1;
                    const rankClass = rank === 1 ? 'first' : rank === 2 ? 'second' : rank === 3 ? 'third' : '';
                    const isCurrentPlayer = this.currentPlayerScore && 
                                          scoreData.pseudo === this.currentPlayerScore.pseudo && 
                                          scoreData.score === this.currentPlayerScore.score;
                    
                    html += `
                        <div class="leaderboard-item ${isCurrentPlayer ? 'current-player' : ''}">
                            <div class="leaderboard-rank ${rankClass}">${rank}</div>
                            <div class="leaderboard-info">
                                <div class="leaderboard-pseudo">${scoreData.pseudo}</div>
                                <div class="leaderboard-details">
                                    Niveau ${scoreData.level} • ${scoreData.accuracy}% précision • ${scoreData.difficulty}
                                    <br><small>${scoreData.date}</small>
                                </div>
                            </div>
                            <div class="leaderboard-score">${scoreData.score}</div>
                        </div>
                    `;
                });
                
                leaderboardList.innerHTML = html;
            }
            
            closeLeaderboard() {
                this.showScreen(this.previousScreen);
            }
            
            // NOUVELLES FONCTIONS ONGLETS MENU PAUSE
            switchTab(tabName) {
                // Supprimer la classe active de tous les onglets et contenus
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // Activer l'onglet et le contenu sélectionnés
                const selectedTab = document.querySelector(`[data-tab="${tabName}"]`);
                const selectedContent = document.getElementById(`${tabName}-content`);
                
                if (selectedTab) selectedTab.classList.add('active');
                if (selectedContent) selectedContent.classList.add('active');
                
                console.log('📑 Onglet changé vers:', tabName);
            }
            
            showScreen(screenId) {
                console.log('🖥️ Changement d\'écran vers:', screenId);
                
                const screens = document.querySelectorAll('.game-screen');
                console.log('🖥️ Écrans trouvés:', screens.length);
                
                // Masquer tous les écrans
                screens.forEach(screen => {
                    screen.classList.remove('active');
                    screen.style.display = 'none'; // Force masquage
                    screen.style.opacity = '0'; // Force opacité 0
                    console.log('📺 Masquage:', screen.id);
                });
                
                // Afficher l'écran cible
                const targetScreen = document.getElementById(screenId);
                if (targetScreen) {
                    targetScreen.classList.add('active');
                    
                    // Force l'affichage selon le type d'écran
                    if (targetScreen.classList.contains('overlay')) {
                        targetScreen.style.display = 'flex';
                        console.log('🔍 Écran overlay affiché en flex:', screenId);
                    } else {
                        targetScreen.style.display = 'block';
                        console.log('🔍 Écran normal affiché en block:', screenId);
                    }
                    
                    // CORRECTION CRITIQUE: Force l'opacité à 1
                    targetScreen.style.opacity = '1 !important';
                    targetScreen.style.visibility = 'visible !important';
                    
                    console.log('✅ Écran affiché:', screenId);
                    
                    // Vérification supplémentaire avec double contrôle
                    setTimeout(() => {
                        const computedStyle = window.getComputedStyle(targetScreen);
                        console.log('🎨 Style calculé pour', screenId, ':', {
                            display: computedStyle.display,
                            visibility: computedStyle.visibility,
                            opacity: computedStyle.opacity
                        });
                        
                        // Double vérification - forcer encore si nécessaire
                        if (parseFloat(computedStyle.opacity) < 0.9) {
                            console.log('⚠️ Opacité faible détectée, correction forcée');
                            targetScreen.style.setProperty('opacity', '1', 'important');
                            targetScreen.style.setProperty('visibility', 'visible', 'important');
                            targetScreen.style.setProperty('display', targetScreen.classList.contains('overlay') ? 'flex' : 'block', 'important');
                        }
                    }, 100);
                } else {
                    console.error('❌ Écran non trouvé:', screenId);
                }
            }
            
            goToGamesMenu() {
                // Implémentation de la fonction goToGamesMenu
                console.log('🎮 Aller au menu des jeux');
            }
        }
        
        // Initialiser le jeu
        document.addEventListener('DOMContentLoaded', () => {
            console.log('📄 DOM chargé, initialisation...');
            const game = new VerbeSlicerSimple();
            window.game = game;
        });
    </script>
</body>
</html> 